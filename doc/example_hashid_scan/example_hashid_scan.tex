
%\documentclass[10pt,twoside,twocolumn]{article}
\documentclass[12pt,twoside]{article}
\usepackage[bf,small]{caption}
\usepackage[letterpaper,hmargin=1in,vmargin=1in]{geometry}
\usepackage{paralist} % comapctitem, compactdesc, compactenum
\usepackage{titlesec}
\usepackage{titletoc}
\usepackage{times}
\usepackage{hyperref}
\usepackage{algorithmic}
\usepackage{graphicx}
\graphicspath{{./graphics/}}
\usepackage{xspace}
\usepackage{verbatim}
\usepackage{url}
\hyphenation{Sub-Bytes Shift-Rows Mix-Col-umns Add-Round-Key}

\setlength{\parskip}{12pt}
\setlength{\parindent}{0pt}

\newcommand{\hdb}{\emph{hashdb}\xspace}
\newcommand{\bulk}{\emph{bulk\_extractor}\xspace}
\newcommand{\mdd}{\emph{md5deep}\xspace}
\newcommand{\bev}{\emph{bulk\_extractor Viewer}\xspace}

\begin{document}

\large Use a Hash Database to Find Part of a Video File in a Media Image
\normalsize
%\author{Bruce Allen}
%\maketitle


%\begin{abstract}
%Use a hash database to find part of a video file in a media image.
%\end{abstract}
Workflow:
\begin{figure}[h]
  \center
  \includegraphics[scale=0.5]{drawings/scan_hashid}
  \caption*{Scan a Media Image for parts of a Video file.}
  \label{fig:scan_hashid}
\end{figure}

Setup: Download the files required for this example:
\begin{compactitem}
\item Hash Database containing hash blocks of Video Files:
\url{www.digitalcorpora.org/downloads/hashdb/examples/db\_of\_video\_hashes}
\item Media Image containing a fragment of a Video File:
\url{www.digitalcorpora.org/downloads/hashdb/examples/media\_image\_with\_fragment}
\item \bulk built with the \hdb \emph{hashid} scanner:
\url{www.digitalcorpora.org/downloads/hashdb/bulk\_extractor-1.4.1-windowsinstaller.exe}
\end{compactitem}

Steps:
\begin{compactenum}
\item Install the two \texttt{.exe} files.
\item Run \bulk built with the \hdb \emph{hashid} scanner:
\begin{verbatim}
$ bulk_extractor -o outdir -S db_of_video_hashes \
  media_image_with_fragment
\end{verbatim}
\item View the feature file using an editor or \bev.
For example type \texttt{vi outdir/identified\_blocks.txt}.
An example match looks like this:
\begin{verbatim}
102400	a2929e2d838b88973b4c4f3d7a96c6d9	1
\end{verbatim}
\end{compactenum}

Seeing hash \texttt{a2929e2d...} at Forensic path \texttt{102400}
shows that something matched our database, but what?
We find the file that contains this hash using a source lookup
using this workflow:
\begin{figure}[h]
  \center
  \includegraphics[scale=0.5]{drawings/source_lookup}
  \caption{Look up the file that has the hash.}
  \label{fig:source_lookup}
\end{figure}

Steps:
\begin{compactenum}
\item Run the \hdb tool to obtain the lookup:
\begin{verbatim}
$ hashdb get_hash_source outdir/identified_blocks.txt \
  identified_sources.txt
\end{verbatim}
\end{compactenum}

Now we view file \texttt{identified\_sources.txt} to see
features containing source information, like this one:
\begin{verbatim}
102400	a2929e2d838b88973b4c4f3d7a96c6d9   repository \
incriminating_video.mpg   8120000
\end{verbatim}

indicating that the block was from file \texttt{incriminating\_video.mpg}.
specifically, the block at forensic path \texttt{102400} came from
the block that is \texttt{8120000} bytes into
video file \texttt{incriminating\_video.mpg}.

\end{document}

